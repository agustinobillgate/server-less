DEFINE TEMP-TABLE t-guest LIKE guest.
DEFINE TEMP-TABLE t-mcguest LIKE mc-guest.

DEFINE INPUT PARAMETER gastnr AS INT.
DEFINE OUTPUT PARAMETER member-flag AS LOGICAL.
DEFINE OUTPUT PARAMETER TABLE FOR t-guest.
DEFINE OUTPUT PARAMETER TABLE FOR t-mcguest.

/*DEFINE VARIABLE gastnr AS INT.
DEFINE VARIABLE token AS CHARACTER.
DEFINE VARIABLE merchant AS INTEGER.
DEFINE VARIABLE member-flag AS LOGICAL.*/

DEFINE VARIABLE i AS INTEGER INIT 0.
DEFINE VARIABLE param1 AS CHARACTER INIT "".
DEFINE VARIABLE status-token    AS CHARACTER    NO-UNDO.

member-flag = NO.

FIND FIRST guest WHERE guest.gastnr = gastnr NO-LOCK NO-ERROR.
IF AVAILABLE guest THEN
DO :
    CREATE t-guest.
    BUFFER-COPY guest TO t-guest.
END.

FIND FIRST mc-guest WHERE mc-guest.gastnr = gastnr AND mc-guest.activeflag NO-LOCK NO-ERROR.
IF AVAILABLE mc-guest THEN
DO :
    member-flag = YES.
    CREATE t-mcguest.
    BUFFER-COPY mc-guest TO t-mcguest.
END.
